# Step 2.1: Create ESLint Configuration

**Part of:** Step 2 from plan.md  
**Focus:** Configure ESLint with TypeScript parser and workspace-specific overrides  
**File to Create:** `.eslintrc.js` (root)  
**Estimated Time:** 15 minutes

## Overview

This substep creates the ESLint configuration that provides linting for TypeScript code across all workspaces. It includes special handling for Next.js frontend code and Node.js backend code through overrides.

## Pre-Substep Checklist

- [ ] **Branch:** Working on `1.1-monorepo-init`
- [ ] **Prior Step:** Completed Step 1 (all root config files created)
- [ ] **Verification:** `npx eslint --version` shows v8.56.0+

## Implementation

### Goal
Create .eslintrc.js with TypeScript support, Next.js frontend rules, and Node.js backend rules.

### Step-by-Step Instructions

#### Step 1: Create .eslintrc.js File
- [ ] Ensure you're in the project root directory
- [ ] Copy and paste the following content into `.eslintrc.js` at the root:

```javascript
module.exports = {
  root: true,
  env: {
    browser: true,
    es2022: true,
    node: true,
  },
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
    'prettier', // Must be last to disable conflicting rules
  ],
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaVersion: 2022,
    sourceType: 'module',
  },
  plugins: ['@typescript-eslint'],
  rules: {
    // TypeScript-specific rules
    '@typescript-eslint/no-unused-vars': [
      'error',
      {
        argsIgnorePattern: '^_',
        varsIgnorePattern: '^_',
      },
    ],
    '@typescript-eslint/no-explicit-any': 'warn',
    '@typescript-eslint/explicit-module-boundary-types': 'off',
    '@typescript-eslint/no-non-null-assertion': 'warn',

    // General rules
    'no-console': ['warn', { allow: ['warn', 'error'] }],
    'prefer-const': 'error',
    'no-var': 'error',
  },
  overrides: [
    // Frontend (Next.js) specific rules
    {
      files: ['src/frontend/**/*.{ts,tsx,js,jsx}'],
      extends: ['next/core-web-vitals'],
      env: {
        browser: true,
        node: false,
      },
      rules: {
        'react/react-in-jsx-scope': 'off', // Next.js 13+ doesn't need React import
        '@next/next/no-html-link-for-pages': 'off',
      },
    },
    // Backend specific rules
    {
      files: ['src/backend/**/*.{ts,js}'],
      env: {
        node: true,
        browser: false,
      },
      rules: {
        'no-console': 'off', // Allow console in backend
      },
    },
    // Shared workspace rules
    {
      files: ['src/shared/**/*.{ts,js}'],
      env: {
        browser: true,
        node: true,
      },
    },
  ],
  ignorePatterns: [
    'node_modules',
    'dist',
    'build',
    '.next',
    'coverage',
    '*.config.js',
    '*.config.ts',
  ],
};
```

#### Step 2: Verify ESLint Configuration
- [ ] Test ESLint configuration syntax:

```bash
npx eslint --print-config .eslintrc.js
```

This should output the merged ESLint configuration without errors.

- [ ] Run ESLint (will pass since no source files exist yet):

```bash
npm run lint
```

Expected output: No files linted (no errors)

## Verification Checklist

- [ ] File saved in correct location: `.eslintrc.js` (at project root)
- [ ] `npm run lint` executes without errors
- [ ] ESLint configuration includes TypeScript parser
- [ ] Frontend override configured for Next.js
- [ ] Backend override configured for Node.js
- [ ] Prettier config is last in extends array (prevents conflicts)

## Troubleshooting

| Issue | Solution |
|-------|----------|
| `Error: Failed to load plugin '@typescript-eslint'` | Run `npm install` to ensure dependencies are installed |
| `Error: Cannot find module 'eslint-config-next'` | Run `npm install` - this was installed in Step 1.1 |
| ESLint and Prettier conflicting | Ensure `'prettier'` is the LAST item in the `extends` array |
| `Parsing error` when linting TS files | Verify `@typescript-eslint/parser` is installed and configured |

## Files Modified

- [ ] âœ… Created: `.eslintrc.js` (root)

## What Comes Next

- Next substep: Step 2.2 - Create Prettier configuration
- ESLint is now configured; Prettier will handle code formatting
