# Step 3.2: Create Backend Workspace Package

**Part of:** Step 3 from plan.md  
**Focus:** Create backend package.json, tsconfig.json, and .env.example  
**Files to Create:**
- `src/backend/package.json`
- `src/backend/tsconfig.json`
- `src/backend/.env.example`

**Estimated Time:** 15 minutes

## Overview

This substep creates the backend workspace with Express and Node.js-specific configuration, TypeScript settings for server-side code, and environment variable templates for API keys and database connections.

## Pre-Substep Checklist

- [ ] **Branch:** Working on `1.1-monorepo-init`
- [ ] **Prior Step:** Completed Step 3.1 (Frontend workspace created)
- [ ] **Folder Status:** `src/backend/` exists (only `.gitkeep` inside)

## Implementation

### Goal
Set up backend workspace as an Express.js API with TypeScript and environment variables.

### Step-by-Step Instructions

#### Step 1: Create Backend package.json
- [ ] Remove `.gitkeep` from `src/backend/`:

```bash
rm src/backend/.gitkeep
```

- [ ] Create `src/backend/package.json`:

```json
{
  "name": "@dovvydive/backend",
  "version": "0.1.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "tsx watch src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js",
    "type-check": "tsc --noEmit",
    "lint": "eslint src --ext .ts"
  },
  "dependencies": {
    "express": "^4.18.2",
    "cors": "^2.8.5",
    "dotenv": "^16.4.1",
    "zod": "^3.22.4",
    "@prisma/client": "^5.8.1"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/cors": "^2.8.17",
    "@types/node": "^20.11.5",
    "tsx": "^4.7.0",
    "prisma": "^5.8.1"
  }
}
```

#### Step 2: Create Backend tsconfig.json
- [ ] Create `src/backend/tsconfig.json`:

```json
{
  "extends": "../../tsconfig.json",
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "lib": ["ES2022"],
    "moduleResolution": "bundler",
    "rootDir": "./src",
    "outDir": "./dist",
    "resolveJsonModule": true,
    "allowJs": false,
    "noEmit": false,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "@shared/*": ["../shared/*"],
      "@shared": ["../shared/index.ts"]
    },
    "types": ["node"]
  },
  "include": [
    "src/**/*.ts"
  ],
  "exclude": [
    "node_modules",
    "dist",
    "**/*.spec.ts",
    "**/*.test.ts"
  ]
}
```

#### Step 3: Create Backend Environment Template
- [ ] Create `src/backend/.env.example`:

```bash
# Server Configuration
NODE_ENV=development
PORT=3001
HOST=localhost

# Database Configuration (Neon PostgreSQL)
DATABASE_URL=postgresql://user:password@localhost:5432/dovvydive?sslmode=require

# Google AI Services
GOOGLE_API_KEY=your_google_api_key_here
GOOGLE_MAPS_KEY=your_google_maps_api_key_here

# External APIs
WEATHER_API_KEY=your_weather_api_key_here

# Security
JWT_SECRET=your_jwt_secret_for_session_signing_min_32_chars
CORS_ORIGIN=http://localhost:3000

# Rate Limiting
RATE_LIMIT_WINDOW_MS=3600000
RATE_LIMIT_MAX_REQUESTS=100

# Logging
LOG_LEVEL=info
```

#### Step 4: Install Backend Dependencies
- [ ] Run npm install from the root to link the workspace:

```bash
npm install
```

This will install Express and related dependencies into `src/backend/node_modules`

## Verification Checklist

- [ ] File created: `src/backend/package.json`
- [ ] File created: `src/backend/tsconfig.json`
- [ ] File created: `src/backend/.env.example`
- [ ] `npm install` completed successfully
- [ ] `src/backend/node_modules` folder exists
- [ ] Workspace linked: `npm ls @dovvydive/backend --depth=0` shows the package

## Troubleshooting

| Issue | Solution |
|-------|----------|
| `npm install` fails with workspace errors | Ensure root `package.json` has workspaces array including `src/backend` |
| Express dependencies not installing | Check internet connection; try `npm cache clean --force` then retry |
| TypeScript extends error | Ensure `../../tsconfig.json` path is correct relative to backend folder |
| Module type errors | Ensure `"type": "module"` is in package.json for ESM support |

## Files Modified

- [ ] ✅ Created: `src/backend/package.json`
- [ ] ✅ Created: `src/backend/tsconfig.json`
- [ ] ✅ Created: `src/backend/.env.example`
- [ ] ✅ Removed: `src/backend/.gitkeep`

## What Comes Next

- Next substep: Step 3.3 - Create Shared workspace package
- Backend workspace is now configured; Express server scaffolding will come in PR 1.4
